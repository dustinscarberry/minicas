{% extends 'dashboard/dashboardbase.html.twig' %}

{% block panel %}

<div class="dashboard-subheader">
  <div class="container-fluid container-fixed-lg">
    <div class="row">
      <div class="col-lg-12">
        <div class="breadcrumb-container">
          <span class="breadcrumb">Dashboard</span>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="dashboard-panels">
  <div class="container-fluid container-fixed-lg">
    <div class="row">
      <div class="col-lg-12">
        <h2>Active Sessions ({{ sessions|length }})</h2>
        <table id="active-session-view-table" class="uk-table uk-table-hover uk-table-striped is-hidden">
          <thead>
            <tr>
              <th>Session Details</th>
              <th>Created</th>
              <th>Expires</th>
              <th></th>
            </tr>
          </thead>
          <tbody>

            {% for session in sessions %}
            <tr data-id="{{ session.hashid }}">
              <td class="active-session-toggledetails">

                {% if session.user is empty %}
                  [Incomplete Session]
                {% else %}
                  {{ session.user }}
                  <i class="fas fa-caret-down active-session-toggledetails-caret"></i>
                  <div class="is-hidden active-session-details" style="margin-top: 1.5rem; padding-left: 2rem;">
                    {% for service in session.authenticatedServices %}

                      <div class="active-session-service active-service-toggleresponse">
                        <span>- {{ service.service.name }}</span>
                        <span>| {{ service.created|date("m/d/Y g:ia", config.siteTimezone) }}</span>
                        <i class="fas fa-caret-down active-service-toggleresponse-caret"></i>
                        <pre class="active-service-response">{{ service.attributes|json_encode(constant('JSON_PRETTY_PRINT')) }}</pre>
                      </div>

                    {% endfor %}

                  </div>

                {% endif %}

              </td>
              <td data-order="{{ session.created }}">{{ session.created|date("m/d/Y g:ia", config.siteTimezone) }}</td>
              <td data-order="{{ session.expiration }}">{{ session.expiration|date("m/d/Y g:ia", config.siteTimezone) }}</td>
              <td>
                <button class="btn btn-error pull-right btn-delete">Delete</button>
              </td>
            </tr>
            {% endfor %}

          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

{% endblock %}
